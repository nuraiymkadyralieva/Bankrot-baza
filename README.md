
# Bankrot-Baza Parser

Инструмент для автоматизации сбора открытых данных о торгах по банкротству с портала bankrotbaza.ru. Программа использует браузерную автоматизацию для навигации по сайту, обработки детальной информации о лотах и выгрузки сведений в формат Excel.

## Основной функционал

Программа реализует полный цикл автоматизированного сбора данных:
* **Автоматизация навигации**: Последовательный переход по страницам поисковой выдачи по заданному адресу.
* **Извлечение детальных карточек**: Переход по прямым ссылкам в каждый лот для сбора характеристик, недоступных в общем списке.
* **Сбор сопутствующих сведений**: Переход на связанные страницы должников для получения ИНН, ОГРН, региона и номера судебного дела.
* **Экспорт в Excel**: Формирование файла .xlsx с автоматической настройкой ширины колонок и базовой очисткой данных.

## Установка и подготовка к работе

Для запуска проекта необходимо выполнить следующие действия:

1. **Подготовка программной среды**:
    * Установить Java JDK версии 17 или выше.
    * Установить браузер Google Chrome для корректной работы Selenium.
2. **Настройка библиотек**:
    * Проект управляется через менеджер зависимостей Maven.
    * Необходимы библиотеки Selenium WebDriver, Apache POI и WebDriverManager.
3. **Конфигурация параметров**:
    * Технические задержки и таймауты задаются через константы HUMAN_CHECK_TIMEOUT_SEC и SLEEP_BETWEEN_LOTS_MS в классе BankrotParser.java.
    * Ссылка для парсинга и лимит обрабатываемых лотов устанавливаются в классе Main.java.

## Технические решения и логика

### Взаимодействие с интерфейсом и авторизация
Для корректного отображения контента и доступа к данным в парсере предусмотрены следующие механизмы:
* **Учёт пользовательских проверок**: В алгоритм заложен таймаут до 90 секунд, позволяющий при необходимости завершить проверку пользователя в окне браузера до продолжения работы.
* **Ожидание авторизации**: Метод waitForLoginIfNeeded приостанавливает работу до 120 секунд для выполнения входа в личный кабинет. Это необходимо для получения доступа к файлам документации, так как ссылки на них доступны только авторизованным пользователям. Программа ориентируется на появление элементов профиля в коде страницы.
* **Регулировка интенсивности**: Между запросами к отдельным лотам установлена пауза в 1200 мс для снижения частоты обращений к серверу.

### Обработка и фильтрация данных
* **Гибкий поиск элементов**: Ссылки на объекты ищутся по набору селекторов, что обеспечивает стабильность работы при изменениях в структуре страниц.
* **Обработка адресных строк**: Адрес объекта извлекается из мета-данных страницы и проходит процедуру очистки от технических маркеров и лишних описаний.
* **Подготовка данных**: При записи в таблицу метод clean приводит значения к единообразному виду, исключая технические артефакты (null, -, н/д) и оставляя ячейки пустыми.

## Используемые технологии
* **Java 17**
* **Selenium WebDriver**: Управление браузером Chrome.
* **Apache POI (XSSF)**: Создание и редактирование файлов Excel.
* **WebDriverManager**: Автоматическая инициализация драйвера браузера.

## Инструкция по запуску
1. Убедиться в наличии установленного браузера Google Chrome.
2. Собрать проект с помощью команды: mvn clean install.
3. Запустить класс Main. Программа инициализирует браузер, перейдет по ссылке и предоставит время для авторизации, после чего начнет сбор сведений.

